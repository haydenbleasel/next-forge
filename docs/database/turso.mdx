---
title: Switch to Turso
description: How to change the database provider from Neon to Turso.
---

import { Authors } from "/snippets/authors.mdx";

<Authors
  data={[
    {
      name: "Hayden Bleasel",
      company: "next-forge",
      username: "haydenbleasel",
      logo: "https://www.next-forge.com/",
    },
    {
      name: "Jamie Barton",
      company: "Turso",
      username: "notrab",
      logo: "https://turso.tech/",
    },
  ]}
/>

[Turso](https://turso.tech) is multi-tenant database platform built for all types of apps, including AI apps with on-device RAG, local-first vector search, that enables on-device RAG, local-first vector search, offline writes, and privacy-focused data access with low-latency.

Here's how to switch from Neon to [Turso](https://turso.tech) for your `next-forge` project.

<Steps>

<Step title="Sign up to Turso">

You can use the [Dashboard](https://app.turso.tech), or the [CLI](https://docs.turso.tech/cli) to manage your account, database, and auth tokens.

_We'll be using the CLI throughout this guide._

</Step>

<Step title="Create a Database">

Create a new database and give it a name using the Turso CLI:

```bash
turso db create <database-name>
```

You can now fetch the URL to the database:

```bash
turso db show <database-name> --url
```

It will look something like this:

```
libsql://<database-name>-<account-or-org-slug>.turso.io
```

</Step>

<Step title="Create a Database Auth Token">

You will need to create an auth token to connect to your Turso database:

```bash
turso db tokens create <database-name>
```

</Step>

<Step title="Update your environment variables">

Update your environment variables to use the new Turso connection string:

<CodeGroup>

```bash apps/database/.env
DATABASE_URL="libsql://<database-name>-<account-or-org-slug>.turso.io"
DATABASE_AUTH_TOKEN="..."
```

```bash apps/app/.env.local
DATABASE_URL="libsql://<database-name>-<account-or-org-slug>.turso.io"
DATABASE_AUTH_TOKEN="..."
```

</CodeGroup>

Now inside `packages/env/index.ts`, add `DATABASE_AUTH_TOKEN` to the `server` and `runtimeEnv` objects:

```ts
const server: Parameters<typeof createEnv>[0]["server"] = {
  // ...
  DATABASE_AUTH_TOKEN: z.string(),
  // ...
};

export const env = createEnv({
  client,
  server,
  runtimeEnv: {
    // ...
    DATABASE_AUTH_TOKEN: process.env.DATABASE_AUTH_TOKEN,
    // ...
  },
});
```

</Step>

<Step title="Install @libsql/client">

The [`@libsql/client`](https://www.npmjs.com/@libsql/client) is used to connect to the hosted Turso database:

Uninstall the existing dependencies for Neon...

<CodeGroup>
    ```sh npm
    npm uninstall @neondatabase/serverless @prisma/adapter-neon ws @types/ws --filter database
    ```

    ```sh pnpm
    pnpm remove @neondatabase/serverless @prisma/adapter-neon ws @types/ws --filter database
    ```

    ```sh yarn
    yarn remove @neondatabase/serverless @prisma/adapter-neon ws @types/ws --filter database
    ```

    ```sh bun
    bun remove @neondatabase/serverless @prisma/adapter-neon ws @types/ws --filter database
    ```

</CodeGroup>

Now install the new dependencies for Turso & libSQL:

<CodeGroup>
    ```sh npm
    npm install @libsql/client --filter database
    ```

    ```sh pnpm
    pnpm add @libsql/client --filter database
    ```

    ```sh yarn
    yarn add @libsql/client --filter database
    ```

    ```sh bun
    bun add @libsql/client --filter database
    ```

</CodeGroup>

</Step>

<Step title="Update Webpack configuration">

Open `packages/next-config/index.ts` and add `@libsql/client` to the list of externals:

```ts packages/next-config/index.ts {5}
let nextConfig: NextConfig = {
  ...config,
  webpack: (config, { isServer }) => {
    if (isServer) {
      config.externals = [...(config.externals || []), "@libsql/client"];
    }

    // ...
  },
};
```

</Step>

<Step title="Update the database connection code">

Open `packages/database/index.ts` and make the following changes:

```ts packages/database/index.ts
import "server-only";

import { createClient } from "@libsql/client";
import { env } from "@repo/env";

const libsql = createClient({
  url: env.DATABASE_URL,
  authToken: env.DATABASE_AUTH_TOKEN,
});

export const database = libsql;
```

</Step>

<Step title="Apply schema changes">

Now connect to the Turso database using the CLI:

```bash
turso db shell <database-name>
```

And apply the schema to the database:

```sql
CREATE TABLE pages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    email TEXT UNIQUE NOT NULL,
    name TEXT
);
```

</Step>

<Step title="Update application code">

Now wherever you would usually call Prisma, use the `libsql` client instead:

```ts packages/app/app/(authenticated)/page.tsx
import { database } from "@repo/database";

type PageType = {
  id: number;
  email: string;
  name?: string;
};

// ...

const { rows } = await database.execute(`SELECT * FROM pages`);

const pages = rows as unknown as Array<PageType>;
```

</Step>

</Steps>
